<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Flou documentation</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Flou documentation</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Hyperbolic-equations"><span>Hyperbolic equations</span></a></li><li><a class="tocitem" href="#Divergence-operators"><span>Divergence operators</span></a></li></ul></li><li><a class="tocitem" href="devs/">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Andres-MG/Flou.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><p><em>Flou</em> is a solver for hyperbolic partial differential equations, using a flux reconstruction approach.</p><h2 id="Hyperbolic-equations"><a class="docs-heading-anchor" href="#Hyperbolic-equations">Hyperbolic equations</a><a id="Hyperbolic-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Hyperbolic-equations" title="Permalink"></a></h2><p>Equations of this type represent conservation laws: <span>$\boldsymbol{q}_t + \nabla\cdot\vec{\boldsymbol{f}} = \boldsymbol{s}$</span>, where the integral values of <span>$\boldsymbol{q}$</span> are only modified by the fluxes through the boundaries or the sources/drains represented by <span>$\boldsymbol{s}$</span>.</p><p>The numerical resolution of this equations requires the discretization of the variables, i.e. the components of <span>$\boldsymbol{q}$</span> and the time, <span>$t$</span>. We rely on <a href="https://docs.sciml.ai/DiffEqDocs/stable/">DifferentialEquations.jl</a> for the temporal term, and <em>Flou</em> provides different spatial discretizations that can be directly integrated in time.</p><h3 id="Flux-reconstruction-(FR)"><a class="docs-heading-anchor" href="#Flux-reconstruction-(FR)">Flux reconstruction (FR)</a><a id="Flux-reconstruction-(FR)-1"></a><a class="docs-heading-anchor-permalink" href="#Flux-reconstruction-(FR)" title="Permalink"></a></h3><p>Starting with the 1D version of a generic conservation law, <span>$q_t + f_x = s$</span>, defined on a certain region of the space, this domain is subdivided in non-overlapping elements. Inside them we represent the spatial distribution of any magnitude as a linear combination of a set of nodal functions, <span>$\phi_i(x)$</span>,</p><p class="math-container">\[q \approx \sum_{i=0}^n q_i \phi_i(x), \quad \phi_i(x_j) = \delta_{ij}.\]</p><p>The fluxes require a little bit more of work. Since they appear in the equation as a derivative, its function approximation must be consistent with the approximation of the rest of the terms. This means that if <span>$\phi_i(x) \in \mathbb{P}^n$</span>, the fluxes should be approximated with a different basis that, when derived, contains <span>$\{\phi_i(x)\}_i$</span>,</p><p class="math-container">\[f \approx \sum_{i=0}^m f_i \psi_i(x), \quad \psi_i(x_j) = \delta_{ij}.\]</p><p>Considering this, and since we are seeking the time derivative of <span>$q_i$</span> at the different solution points <span>$\{x_0, \dots, x_n\}$</span>, the discretization would be as follows,</p><p class="math-container">\[J_i(q_t)_i \approx -\sum_{j=0}^m f_j \psi_j&#39;(x_i) + s(x_i), \quad i = 0, \dots, n.\]</p><p>Now we recall that our spatial domain is divided in a set of elements, and we have not imposed that the appoximations inside our elements are continous. In general, the numerical solution that we obtain with these methods is not continuous accross elements. However, information must be able to travel throughout the domain and we introduce this in our mathematical discretization with numerical fluxes, <span>$f^\star$</span>. They act on two different states, <span>$q_l$</span> and <span>$q_r$</span>, and return a sort of &quot;common&quot; flux by approximating the Riemann problem defined by the discontinuity between <span>$q_l$</span> and <span>$q_r$</span>.</p><p>We use this at the element interfaces, so that the information arriving at one of the element boundaries is transmited by means of the discontinuity that it creates. To apply this to our numerical discretization, we first compute the values of <span>$q$</span> at a new set of points, <span>$\{\xi_0, \dots \xi_m\}$</span> that includes the boundaries, <span>$\xi=-1, \xi=1$</span>. We compute the fluxes there as <span>$f_i = f(\xi_i) = f(q(\xi_i))$</span> and also use the values of <span>$q$</span> at the boundaries to obtain <span>$f^\star_l$</span> and <span>$f^\star_r$</span>. We are now ready to represent the approximation of the flux taking into account the neighbouring elements,</p><p class="math-container">\[f \approx \sum_{i=0}^m f_i \psi_i(x) + \left(f^\star_l - \sum_{i=0}^m f_i \psi_i(-1)\right)g_l(x) + \left(f^\star_r - \sum_{i=0}^m f_i \psi_i(+1)\right)g_r(x).\]</p><p>The functions <span>$g_l(x)$</span> and <span>$g_r(x)$</span> are called reconstruction functions and there are several options. They are simply required to be valued <span>$1$</span> on &quot;their&quot; side and <span>$0$</span> on the other. In the next chapters we will see that other spatial discretizations can be recasted into the flux reconstruction framework by a certain choice of reconstruction functions. Finally, the FR spatial discretization is,</p><p class="math-container">\[J_i(q_t)_i \approx -\sum_{j=0}^m f_j \psi_j&#39;(x_i) + \left(f^\star_l - \sum_{i=0}^m f_i \psi_i(-1)\right)\left.\frac{dg_l}{dx}\right\rvert_{x_i} + \left(f^\star_r - \sum_{i=0}^m f_i \psi_i(+1)\right)\left.\frac{dg_r}{dx}\right\rvert_{x_i} + s(x_i).\]</p><h3 id="Discontinuous-Galerkin-Spectral-Element-Method-(DGSEM)"><a class="docs-heading-anchor" href="#Discontinuous-Galerkin-Spectral-Element-Method-(DGSEM)">Discontinuous Galerkin Spectral Element Method (DGSEM)</a><a id="Discontinuous-Galerkin-Spectral-Element-Method-(DGSEM)-1"></a><a class="docs-heading-anchor-permalink" href="#Discontinuous-Galerkin-Spectral-Element-Method-(DGSEM)" title="Permalink"></a></h3><h3 id="Extension-to-higher-dimensions-in-tensor-product-elements"><a class="docs-heading-anchor" href="#Extension-to-higher-dimensions-in-tensor-product-elements">Extension to higher dimensions in tensor-product elements</a><a id="Extension-to-higher-dimensions-in-tensor-product-elements-1"></a><a class="docs-heading-anchor-permalink" href="#Extension-to-higher-dimensions-in-tensor-product-elements" title="Permalink"></a></h3><p>Weak form in 2D for tensor-product elements:</p><p class="math-container">\[M \dot{\boldsymbol{Q}}_{ij} = \sum_k^{N_x} K^{(j)}_{x,ik} \tilde{\boldsymbol{f}}_{kj} + \sum_k^{N_y} K^{(i)}_{y,jk} \tilde{\boldsymbol{g}}_{ik} - \sum_d^2 L_{\omega_x,ij}^{(d)} \boldsymbol{f}_{n,i}^\star - \sum_d^2 L_{\omega_y,ij}^{(d)} \boldsymbol{g}_{n,j}^\star\]</p><p>Strong form in 2D for tensor-product elements:</p><p class="math-container">\[M \dot{\boldsymbol{Q}}_{ij} = \sum_k^{N_x} \hat{K}^{(j)}_{x,ik} \tilde{\boldsymbol{f}}_{kj} + \sum_k^{N_y} \hat{K}^{(i)}_{y,jk} \tilde{\boldsymbol{g}}_{ik} - \sum_d^2 L_{\omega_x,j}^{(d)} \boldsymbol{f}_{n,i}^\star - \sum_d^2 L_{\omega_y,ij}^{(d)} \boldsymbol{g}_{n,j}^\star\]</p><p>The matrices are defined as follows:</p><p class="math-container">\[\begin{gathered}
M = \text{diag}(J_{ij}\omega_{x,i}\omega_{y,j}), \\
K^{(j)}_{x,ik} = \omega_{y,j}\omega_{x,k}D_{x,ki}, \\
K^{(i)}_{y,jk} = \omega_{x,i}\omega_{y,k}D_{y,kj}, \\
\hat{K}^{(j)}_{x,ik} = -\omega_{y,j}\omega_{x,i}D_{x,ik} + \omega_{y,j}\left[l_{x,i}(1)l_{x,k}(1) - l_{x,i}(-1)l_{x,k}(-1)\right], \\
\hat{K}^{(i)}_{y,jk} = -\omega_{x,i}\omega_{y,j}D_{y,jk} + \omega_{x,i}\left[l_{y,j}(1)l_{y,k}(1) - l_{y,j}(-1)l_{y,k}(-1)\right], \\
L_{\omega_x,ij}^{(1)} = \omega_{y,j}l_{x,i}(-1), \\
L_{\omega_x,ij}^{(2)} = \omega_{y,j}l_{x,i}(1), \\
L_{\omega_y,ij}^{(1)} = \omega_{x,i}l_{y,j}(-1) \\
L_{\omega_y,ij}^{(2)} = \omega_{x,i}l_{y,j}(1).
\end{gathered}\]</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Notice that the operators in 2D are very similar to the ones in 1D. They are simply the tensor product of their 1D versions with the vector <span>$\vec{\omega}$</span> corresponding to the other direction. For example, <span>$K^{\text{2D}}_x = K^{\text{1D}}_x \otimes \omega_y$</span>, which is a third order tensor with size <span>$N_x \times N_x \times N_y$</span>.</p></div></div><h2 id="Divergence-operators"><a class="docs-heading-anchor" href="#Divergence-operators">Divergence operators</a><a id="Divergence-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Divergence-operators" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Flou.FlouSpatial.SSFVDivOperator" href="#Flou.FlouSpatial.SSFVDivOperator"><code>Flou.FlouSpatial.SSFVDivOperator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SSFVDivOperator([tpflux=numflux.avg, [fvflux=numflux]], numflux, blend)</code></pre><p>Split-divergence operator in telescopic form. Only implemented for tensor-product elements.</p><p>The telescopic operator approach effectively turns the initial split formulation into a sub-element finite volume scheme. The <code>twopointflux</code> and <code>fvflux</code> are both combined into an entropy-stable interface flux that controls the volume dissipation through the subcell interface Riemann solver.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Andres-MG/Flou.jl/blob/6d53bac825e10a5d86f3557bef69518d2ad7876a/src/FlouSpatial/FR/OpDivergence.jl#L377-L386">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Flou.FlouSpatial.SplitDivOperator" href="#Flou.FlouSpatial.SplitDivOperator"><code>Flou.FlouSpatial.SplitDivOperator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SplitDivOperator([tpflux=numflux.avg], numflux)</code></pre><p>Split-divergence operator, only implemented for tensor-product elements. The two-point flux represents the splitting strategy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Andres-MG/Flou.jl/blob/6d53bac825e10a5d86f3557bef69518d2ad7876a/src/FlouSpatial/FR/OpDivergence.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Flou.FlouSpatial.requires_subgrid-Tuple{Flou.FlouSpatial.AbstractDivOperator, Flou.FlouSpatial.AbstractStdRegion}" href="#Flou.FlouSpatial.requires_subgrid-Tuple{Flou.FlouSpatial.AbstractDivOperator, Flou.FlouSpatial.AbstractStdRegion}"><code>Flou.FlouSpatial.requires_subgrid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">requires_subgrid(divergence, std)</code></pre><p>Return <code>true</code> if the specified <code>divergence</code> operator needs the allocation of the subcell grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Andres-MG/Flou.jl/blob/6d53bac825e10a5d86f3557bef69518d2ad7876a/src/FlouSpatial/FR/OpDivergence.jl#L3-L8">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="devs/">Developers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 19 January 2023 18:57">Thursday 19 January 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
